
<style>

    .tabContainer-tabs {
        width: 100%;
        display:inline-block;
        margin-top: -40px;
    }

    .tabContainer-tab-content {
        padding: 15px;
    }

    .tab {
        display: none;
    }

    .tab active {
        display: block;
    }

#guide_content .breadcrumb a {
  color: black;
}

.breadcrumb {
    padding: 0px;
    background: transparent;
    list-style: none;
    overflow: hidden;
    margin-bottom: 20px;
    border-radius: 4px;
}


.breadcrumb>li {
    display: table-cell;
    vertical-align: top;
    width: 1%;
}

.breadcrumb>li+li:before {
    padding: 0;
}

.breadcrumb li a {
    color: white;
    text-decoration: none;
    padding: 10px 0 10px 45px;
    position: relative;
    display: inline-block;
    width: calc( 100% - 10px );
    background-color: hsla(0, 0%, 83%, 1);
    text-align: center;
    text-transform: capitalize;
}

.breadcrumb li.completed a {
    background: #aaaaee;
}

.breadcrumb li.completed a:after {
    border-left: 30px solid #aaaaee;
}

.breadcrumb li.active a {
    background: #7f7fe6;
    color: black;
}

.breadcrumb li.active a:after {
    border-left: 30px solid #7f7fe6;
}

.breadcrumb li:first-child a {
    padding-left: 15px;
}

.breadcrumb li:last-of-type a {
    width: calc( 100% - 10px );
}

.breadcrumb li a:before {
    content: " ";
    display: block;
    width: 0;
    height: 0;
    border-top: 50px solid transparent;
    border-bottom: 50px solid transparent;
    border-left: 30px solid white;
    position: absolute;
    top: 50%;
    margin-top: -50px;
    margin-left: 1px;
    left: 100%;
    z-index: 1;
    color: black;
}

.breadcrumb li a:after {
    content: " ";
    display: block;
    width: 0;
    height: 0;
    border-top: 50px solid transparent;
    border-bottom: 50px solid transparent;
    border-left: 30px solid hsla(0, 0%, 83%, 1);
    position: absolute;
    top: 50%;
    margin-top: -50px;
    left: 100%;
    z-index: 2;
}

.nextTabButton {
    float: right;
    /* display: none; */
}

</style>





<div class="failureThresholdSteps">
    <div class='tabContainer-tabs'>
        <ul class='breadcrumb'>
            <li class='active'><a href='#failureThreshold-edit'>Configure @CircuitBreaker Annotation</a></li>
            <li><a href='#failureThreshold-action'>See it in Action</a></li>
            <li class='last-of-type'><a href='#failureThreshold-playGround'>Try Other Values</a></li>
        </ul>
    </div>
    <div class='tabContainer-tab-content'>
        <div id='failureThreshold-edit' class='tab active'>
            <div class='editorHolder' id='editorHolder'>
            </div>
        </div>
        <div id='failureThreshold-action' class='tab'>
            <div class='browserHolder' style='width:50%; display:inline-block;'>
            </div>
            <div class='explanationHolder' style='display:inline-block; margin-left: 20px; width:45%; vertical-align:top;'>
            </div>
            <button class='btn btn-default selectedButton nextTabButton'>Configure it</button>   
        </div>
        <div id='failureThreshold-playGround' class='tab'>
            <instruction style='display:inline-block'>
                <b>Modify the @CircuitBreaker parameters</b> and <b>save the file</b> in the editor to configure your circuit breaker.
                <br>You can simulate successful or failed requests to the microservice to see how the circuit state changes.
            </instruction> <br>
            <div class='playGround'>
                <div class='editorHolder2' style='margin-top:30px; width:50%; display:inline-block;'>
                </div>
                <div class='playgroundHolder' style='display:inline-block; margin:30px 0 0 10px; width: 45%; vertical-align:top;'>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    var content = {
        fileName: "BankService.java",
        preload: [
            "package global.eBank.microservices;",
            "import org.eclipse.microprofile.faulttolerance.CircuitBreaker;",
            "import org.eclipse.microprofile.faulttolerance.exceptions.*;",
            "",
            "public class BankService {",
            "",
            "    @CircuitBreaker()",
            "    public Service checkBalance() {",
            "        counterForInvokingBankingService++;",
            "        return checkBalanceService();",
            "    }",
            "}"
        ],
        readonly: false,
        save: true,
        callback: "(function test(editor) {circuitBreakerCallBack.listenToEditorForAnnotationParamChange(editor); })"
    };
    var newEditor = editor.create($('.editorHolder'), "ConfigureFailureThreshold2", content);
    contentManager.setEditor("ConfigureFailureThreshold2", newEditor);

    var content2 = {
        url: "https://global-ebank.com/checkBalance",
        browserContent: "../../../html/interactive-guides/circuit-breaker/check-balance-fail-with-open-circuit.html",
        callback: "(function test(webBrowser) {circuitBreakerCallBack.listenToBrowserForFailBalance(webBrowser); })"
    };
    var newWebBrowser = webBrowser.create($('.browserHolder'), "ConfigureFailureThreshold2",  content2);
    contentManager.setWebBrowser("ConfigureFailureThreshold2", newWebBrowser);

    var content2a = {
        size: "40%"
    }
    var newPod = pod.create($('.explanationHolder'), "ConfigureFailureThreshold2", content2a);
    contentManager.setPod("ConfigureFailureThreshold2", newPod);

    var content3 = {
        fileName: "BankService.java",
        preload: [
            "package global.eBank.microservices;",
            "import org.eclipse.microprofile.faulttolerance.CircuitBreaker;",
            "import org.eclipse.microprofile.faulttolerance.exceptions.*;",
            "",
            "public class BankService {",
            "",
            "    @CircuitBreaker(requestVolumeThreshold=4,",
            "                    failureRatio=0.5)",
            "    public Service checkBalance() {",
            "        counterForInvokingBankingService++;",
            "        return BankingService();",
            "    }",
            "}"
        ],
        readonly: [
            {
            "from": "1",
            "to": "6"
            },
            {
            "from": "9",
            "to": "13"
            }
        ],
        save: true,
        callback: "(function test(editor) {circuitBreakerCallBack.listenToEditorForCircuitBreakerAnnotationChanges(editor); })"
    };
    var newEditor2 = editor.create($('.editorHolder2'), "ConfigureFailureThreshold2", content3);
    contentManager.setEditor("ConfigureFailureThreshold2", newEditor2);

    var content4 = {
        content: "../../../html/interactive-guides/circuit-breaker/circuit-breaker-playground.html",
        callback: "(function(pod) {circuitBreakerCallBack.createCircuitBreaker(pod, 'ConfigureFailureThreshold2', 4, 0.5, 5000, 20, ['requestVolumeThreshold', 'failureRatio'])})"
    };
    var newPod1 = pod.create($('.playgroundHolder'), "ConfigureFailureThreshold2", content4);
    contentManager.setPod("ConfigureFailureThreshold2", newPod1);
</script>


<script>
    $('.failureThresholdSteps .tabContainer-tabs .breadcrumb a').on('click', function(e) {
        var liElement = $(this).parent('li');
        if (liElement.hasClass('completed') || liElement.hasClass('active')) {
            // A completed element may be selected when clicked on
            var currentAttrValue = $(this).attr('href');
            // show/hide tabs
            $('.failureThresholdSteps .tabContainer-tab-content ' + currentAttrValue).slideDown(400).siblings().slideUp(400);
            // change/remove current tab to active
            $(this).parent('li').addClass('active').siblings().removeClass('active');
        }

        e.preventDefault();
    });
    $('.failureThresholdSteps .tabContainer-tabs .breadcrumb a').first().click();
    $('.nextTabButton').on('click', function(e) {
        // $('.failureThresholdSteps .tabContainer-tabs .breadcrumb a').last().click();
        var stepPod = contentManager.getPod("ConfigureFailureThreshold2", 2).accessPodContent();
        var breadcrumbElement = stepPod.find('.failureThresholdSteps > .tabContainer-tabs > .breadcrumb');
        var activeStep = breadcrumbElement.find('li.active');
        activeStep.next().find('a').click();
    });
</script>
